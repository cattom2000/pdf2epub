# 处理模式说明

## 概述

PDF转EPUB转换器支持两种处理模式：
1. **富文本模式 (rich)** - 默认模式，保持原始文档格式
2. **纯文本模式 (simple)** - 兼容旧版的处理方式

## 富文本模式 (rich)

### 特点
- 保持原始文档的标题层级结构
- 识别并应用文本对齐样式（居中、左对齐、右对齐）
- 智能提取章节标题，避免使用"Page X"这样的默认标题
- 更好地保持原始文档的版面布局

### 工作流程
1. 使用 `extract_rich_structure` 方法提取结构化数据
2. 识别文档中的标题层级（heading level 1, 2, 3等）
3. 提取段落内容和文本对齐信息
4. 智能提取章节标题并从正文中移除
5. 使用 `create_epub_from_structure` 方法生成EPUB

### 适用场景
- 需要保持原始文档格式的正式文档
- 包含多级标题的书籍或报告
- 对版面布局有较高要求的文档

## 纯文本模式 (simple)

### 特点
- 兼容旧版处理方式
- 使用"##"标记识别标题
- 保持段落换行处理的连续性
- 适用于简单的文本转换需求

### 工作流程
1. 使用 `extract_text` 方法提取文本
2. 识别文本中的"##"标记作为标题
3. 智能提取章节标题并从正文中移除
4. 使用 `create_epub_with_toc` 方法生成EPUB

### 适用场景
- 简单的文本内容转换
- 向后兼容旧版处理流程
- 对格式要求不高的文档

## 使用示例

### 富文本模式
```bash
# 默认使用富文本模式
python src/main.py --input book.pdf --output book.epub

# 显式指定富文本模式
python src/main.py --input book.pdf --output book.epub --mode rich
```

### 纯文本模式
```bash
# 使用纯文本模式
python src/main.py --input book.pdf --output book.epub --mode simple
```

## 格式保持功能

### 标题层级识别
- 自动识别文档中的标题层级
- 保持原始的标题结构关系
- 避免人工生成的标题

### 文本对齐样式
- 识别居中、左对齐、右对齐等样式
- 在EPUB中正确应用文本对齐
- 保持原始文档的视觉效果

### 智能标题提取
- 从内容中智能提取真实章节标题
- 避免使用"Page X"这样的默认标题
- 保持目录结构的准确性

## 注意事项

1. 富文本模式需要Gemini模型支持结构化数据提取
2. 对于简单文档，两种模式效果差异不大
3. 复杂排版文档建议使用富文本模式
4. 如果遇到格式识别问题，可以尝试切换到纯文本模式